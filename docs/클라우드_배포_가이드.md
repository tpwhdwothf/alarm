# 클라우드 배포 가이드 (24/7 운영)

봇과 시세 워커를 **서버에 올려서** PC를 끄더라도 24시간 알림이 가도록 하는 방법입니다.  
**무료·저비용** 옵션 위주로 정리했습니다. (각 서비스 정책은 변경될 수 있으니 배포 전 공식 사이트에서 한 번 더 확인하세요.)

---

## 1. 요약 비교표

| 서비스 | 무료 여부 | 24/7 동작 | 난이도 | 주요 제한 |
|--------|-----------|-----------|--------|------------|
| **Oracle Cloud** | ✅ 항상 무료 | ✅ 가능 | 중 | 가입 시 카드 필요, VM 직접 설정 |
| **Render** | ✅ 무료 | ⚠️ 15분 미사용 시 슬립 | 쉬움 | 슬립 후 재접속 시 1분 내 재시작 |
| **Railway** | ⚠️ 크레딧 후 유료 | ✅ 가능 | 쉬움 | 월 $5 크레딧 소진 후 과금 |
| **Fly.io** | ⚠️ 사용량 기반 | ✅ 가능 | 중 | 개인용 $5 면제 등, 소액 과금 가능 |
| **Koyeb** | ✅ 무료 | ⚠️ 비활성 시 스케일 제로 가능 | 쉬움 | 무료 1서비스, 슬립 정책 확인 필요 |

---

## 2. 옵션별 상세

### 2-1. Oracle Cloud (Always Free) — 진짜 무료 24/7

**설명**  
항상 무료(Always Free) VM을 제공합니다. 한 번 만들면 **시간 제한 없이** 24/7 켜 둘 수 있습니다.

**장점**
- **완전 무료** (VM 리소스 항상 무료 범위 내)
- 슬립 없음, 24시간 동작
- 메모리/CPU 여유 있으면 봇 + 워커 동시 실행 가능

**단점**
- 가입 시 **신용/체크카드** 필요 (검증용, 무료 한도 내에서는 과금 없음)
- VM 생성·SSH·Node 설치·PM2 설정 등 **직접 서버 세팅** 필요
- 한국 리전이 없어 지연이 조금 있을 수 있음 (보통 큰 문제는 아님)

**제한 (Always Free 한도 상세)**

- **VM 종류 (둘 중 하나만 사용 가능)**  
  - **AMD (Micro)**: VM.Standard.E2.1.Micro **최대 2개** (1 vCPU, 1GB RAM each)  
  - **ARM (Ampere A1)**: **월 3,000 OCPU·시간 + 18,000 GB·시간** → 상시 사용 시 **4 OCPU + 24GB 메모리** 수준 (인스턴스 1개로 4코어/24GB 또는 여러 개로 나눠 사용)
- **스토리지**: 블록 볼륨 **200GB** (Always Free)
- **네트워크**: 퍼블릭 IP 1개, **최대 480Mbps** (속도 제한만 있고, Always Free VM 기준으로 이그레스(나가는 트래픽) 월간 용량 제한은 공식 문서에 명시되지 않음 — 소규모 봇/API 호출은 보통 문제 없음)
- **기간**: **만료 없음** (Always Free는 계정 유지 시 계속 제공)
- **리전**: 가입 시 정한 **홈 리전 1개** 안에서만 Always Free 리소스 사용 가능

**우리 봇 기준**  
- AMD Micro 1개(1 vCPU, 1GB RAM)만 써도 봇 + 시세 워커 동시 실행에 충분한 수준입니다.  
- ARM은 더 여유 있지만, 생성 가능한 리전/가용성이 제한될 수 있어, 처음에는 AMD Micro 2개 중 1개로 시작해도 됩니다.

**적합한 경우**  
- 완전 무료로 24/7 돌리고 싶을 때  
- 터미널/SSH로 서버 설정하는 것에 거부감이 없을 때  

**비개발자도 세팅할 수 있나요?**  
- **직접만 하면** 처음엔 어렵게 느껴질 수 있습니다. (가입 → VM 생성 → SSH 접속 → Node 설치 → 코드 올리기 → 환경변수 → PM2 실행 등 단계가 많고, “터미널”, “SSH” 같은 걸 처음 써 보면 낯설 수 있음.)  
- **단계별 가이드를 보고, AI(챗봇)와 함께** 진행하면 **비개발자도 할 수 있습니다.**  
  - 가이드에서 “1단계: 가입”, “2단계: VM 만들기” 처럼 **순서대로**만 따라 하면 됩니다.  
  - **막히는 단계**가 있으면 그 단계만 캡처하거나 메시지로 알려주면, 다음에 뭘 눌러야 할지·어떤 명령을 넣어야 할지 구체적으로 안내받을 수 있습니다.  
- 정리하면, “어렵다”기보다 **할 일이 많고 순서가 중요**한 편이라, **가이드 + 막힐 때마다 질문**하면 충분히 따라 할 수 있는 수준입니다.  
- 상세 단계는 **[Oracle_Cloud_세팅_가이드.md](Oracle_Cloud_세팅_가이드.md)** 에 정리해 두었습니다.

---

### 2-2. Render (Free Tier)

**설명**  
GitHub 연동 후 소스만 올리면 배포할 수 있는 PaaS입니다. 무료 플랜은 **15분 동안 요청이 없으면 인스턴스가 슬립**합니다.

**장점**
- 설정이 **쉬움** (Git push로 배포)
- 카드 없이 가입 가능
- 월 750시간 무료 인스턴스

**단점**
- **15분 미사용 시 슬립** → 그동안 봇·워커가 멈춤
- 슬립 후 첫 요청 시 **재시작에 1분 내외** 소요 → 그 사이에 오는 메시지/시세는 놓칠 수 있음

**제한**
- 750 free instance hours/월 (한 서비스 24/7이면 약 31일치라 한 개만 켜두면 됨)
- 슬립 때문에 “진짜 24/7”는 아님

**적합한 경우**  
- 테스트·가벼운 사용  
- “가끔만 알림 받아도 된다” 수준일 때  

**참고**  
- 봇은 텔레그램이 우리 서버로 계속 폴링하므로 “요청”이 있어서, **봇만 올리면** 슬립이 덜 할 수 있음.  
- 하지만 **시세 워커**는 우리가 주기적으로만 외부 API 부르는 구조라, Render가 이를 “유휴”로 볼 수 있어 슬립될 수 있습니다.  
→ **24/7 알림이 중요하면** Render 무료보다는 Oracle Cloud 또는 유료 플랜을 권장합니다.

---

### 2-3. Railway

**설명**  
Git 기반 배포, 로그·모니터링이 편한 PaaS입니다. 슬립 없이 계속 켜 둡니다.

**장점**
- **슬립 없음** → 24/7 동작에 적합
- 배포가 쉬움 (GitHub 연동)
- 봇 + 워커를 한 프로젝트에서 두 서비스로 나눠 배포 가능

**단점**
- 완전 무료 플랜이 없고, **월 $5 크레딧** 제공 후 사용량만큼 차감
- 소규모 봇이어도 한 달 돌리면 **몇 달러** 나올 수 있음 (보통 $5 안에 들어가는 경우 많음)

**제한**
- Hobby 플랜: $5/월 크레딧 등 (정책 확인 필요)
- 크레딧 소진 후 결제 수단 없으면 중단

**적합한 경우**  
- “매달 소액(수 달러) 내도 되고, 설정은 쉽게 가고 싶다” 할 때  

---

### 2-4. Fly.io

**설명**  
VM을 지역별로 띄우는 플랫폼입니다. 사용량 기반 과금이고, **개인용**은 일정 금액(예: $5)까지 면제 등이 있을 수 있습니다.

**장점**
- 슬립 없이 **24/7** 실행 가능
- 리전 선택으로 지연 줄이기 좋음

**단점**
- 완전 무료가 아니라 **사용량 기반** (소액 과금 가능)
- Dockerfile·fly.toml 등 설정이 Render보다 다소 복잡

**제한**
- 신규 가입자 기준 무료 티어가 축소/변경된 상태이며, 과금 정책이 바뀔 수 있음 → 공식 사이트 확인 필요

**적합한 경우**  
- 소액 과금은 감수하고, 24/7 + 지역 선택이 중요할 때  

---

### 2-5. Koyeb

**설명**  
무료 1개 Web Service를 제공합니다. “Scale-to-zero” 옵션이 있으면 **비활성 시 인스턴스가 줄어들거나** 슬립될 수 있습니다.

**장점**
- **카드 없이** 무료 가입 가능
- 배포가 비교적 쉬움

**단점**
- 비활성 시 **슬립/스케일 제로** 가능 → 24/7이 보장되지 않을 수 있음
- 무료는 1서비스만 (봇+워커를 한 프로세스로 묶어야 할 수 있음)

**제한**
- 무료 1 Web Service, 리소스 제한 (정책 확인)

**적합한 경우**  
- “무료로 한 번 배포 경험해 보고, 슬립은 나중에 확인해 보자” 할 때  

---

## 3. 추천 정리

| 목적 | 추천 |
|------|------|
| **완전 무료 + 24/7** | **Oracle Cloud** Always Free VM + Node + PM2 (서버 설정 필요) |
| **설정은 쉽게 + 24/7** | **Railway** (월 소액 과금 감수) |
| **완전 무료 + “가끔만” 알림** | **Render** 무료 (슬립 가능성 인지하고 사용) |

---

## 4. 배포 시 공통으로 할 일

어떤 서비스를 쓰든, 대략 다음은 맞춰야 합니다.

1. **봇과 워커를 둘 다 실행**  
   - 서버에서 `npm run dev`(봇) + `npm run worker:kis`(시세) 를 **동시에** 돌리거나  
   - PM2 등으로 **두 프로세스**로 관리

2. **환경 변수 설정**  
   - 서버의 환경 변수에  
     `TELEGRAM_BOT_TOKEN`, `SUPABASE_URL`, `SUPABASE_ANON_KEY`, `KIS_APP_KEY`, `KIS_APP_SECRET`  
     등을 넣기 (각 플랫폼의 “Environment” 또는 “Config” 메뉴 사용).

3. **저장소 연동**  
   - GitHub에 코드 올린 뒤, 해당 서비스에서 저장소 연결 후 자동 배포 설정.

원하시면 **Oracle Cloud** 또는 **Railway** 중 하나를 골라서, “그 서비스 기준으로 단계별 배포 절차”를 이 문서에 이어서 정리해 드리겠습니다.
